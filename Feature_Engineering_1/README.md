# Instacart Market Basket Competition on Kaggle

This project focuses on solving the Instacart Market Basket problem with multiple approaches. Please note that the folder structure and file paths may vary slightly as Google Colab and Kaggle environments are used for execution. Ensure that you modify the directory paths accordingly for your code.

The solution is based on public code of *University of Macedonia* and top 2 competition *ONODERA*
## Steps to Run the Code

1. **Run `prepare_data_fe1.ipynb`**:
   - This script prepares features required for the XGBoost model.
2. **Run `submission_xgb_fe1.ipynb`**:
   - This script trains the XGBoost model on the prepared features and generates predictions for submission.

## Important Notes on Features

The features engineered in this approach contain key information about user-product interactions:

- **Total Bought**:
  - The total number of times each product is purchased by a specific user.
  
- **One-Shot Ratio Products**:
  - The ratio of products that are only purchased once by the user.
  
- **Time Last 5 Ratio**:
  - The ratio of purchases for a product within the last 5 orders of a user.
  
- **Reorder Ratio**:
  - The ratio of a product being reordered across all users. A higher ratio indicates that the product is likely to be reordered by other customers as well.
  
- **Order Size Average (`Order_size_avg`)**:
  - The average number of products per order for each user.
  
- **Item NX Ratio**:
  - The ratio of a product being reordered within the last X orders of a user (X = 1, 2, ..., 5).
  
- **Distance Features**:
  - **Cosine Similarity**:
    - Measures the similarity between a user and a product based on their historical interactions.
  - **Embedding Product with BERT**:
    - Represents each product using embeddings generated by a BERT model.
    - Orders are represented by the average embedding of the products within the order.
    - Users are represented by a weighted average embedding of their orders, weighted by the order sequence.

## Folder Structure and File Information

- **`Feature_Engineering_1`**:
  - Contains the first approach for feature engineering and traditional ML with XGBoost.
  - Files:
    1. `prepare_data_fe1.ipynb`: Feature preparation.
    2. `submission_xgb_fe1.ipynb`: Training and submission using XGBoost.

Make sure to adapt folder paths in your code depending on your working environment (e.g., Google Colab or Kaggle Notebook).
